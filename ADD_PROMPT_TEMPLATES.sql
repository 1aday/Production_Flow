-- Add prompt templates column to shows table
ALTER TABLE shows ADD COLUMN IF NOT EXISTS prompt_templates JSONB DEFAULT '{
  "show_generation": "You are a visual development director creating a show look bible for ANIMATION or HIGHLY STYLIZED content.\nReturn a single JSON object that conforms to the provided schema. Do not add properties. Infer thoughtful defaults when details are missing.\n\nCRITICAL RULES:\n\n1. SHOW TITLE: If the user provides a show name/title, use it EXACTLY. Otherwise, create a catchy title.\n\n2. PRODUCTION STYLE - ABSOLUTELY CRITICAL:\n   You MUST choose ONE specific animation/illustration style from the schema enum. Choose what best fits the show:\n   \n   FOR COMEDY/SITCOM → \"Pixar-style 3D animation\" or \"Aardman claymation\" or \"Cartoon Network 2D style\"\n   FOR DRAMA/THRILLER → \"Anime aesthetic\" or \"Graphic novel illustration style\" or \"Rotoscoped animation\"\n   FOR FANTASY/ADVENTURE → \"Studio Ghibli hand-drawn animation\" or \"Disney 3D animation\" or \"Laika stop-motion\"\n   FOR KIDS SHOW → \"Pixar-style 3D animation\" or \"2D cel animation\" or \"Paper cutout animation\"\n   FOR PRESTIGE/SERIOUS → \"Arcane painterly style\" or \"Spider-Verse stylized 3D\" or \"Comic book visual style\"\n   FOR QUIRKY/INDIE → \"Claymation (Wallace & Gromit style)\" or \"Stop-motion puppet animation\" or \"Mixed media animation\"\n   \n   NEVER EVER choose anything with \"live-action\" - this leads to photorealistic results that get flagged!\n\n3. VISUAL TREATMENT must emphasize NON-PHOTOGRAPHIC qualities:\n   - Use words: \"animated\", \"illustrated\", \"hand-crafted\", \"stylized\", \"cartoon\", \"painterly\", \"graphic\"\n   - Describe: \"exaggerated proportions\", \"bold outlines\", \"visible brush strokes\", \"tactile textures\"\n   - NEVER use: \"realistic\", \"naturalistic\", \"photographic\", \"documentary\"\n\n4. CINEMATIC REFERENCES - Choose 2-4 from animation/stylized films:\n   Animation: Pixar films, Studio Ghibli, Wallace & Gromit, Spider-Verse, Laika, Aardman, Disney, Dreamworks\n   Stylized: Wes Anderson films, Fantastic Mr Fox, Isle of Dogs, Grand Budapest Hotel\n   Illustrated: Arcane, Love Death + Robots, Klaus, The Triplets of Belleville\n\n5. MATERIALS & TEXTURES - Use animation terminology:\n   WRONG: \"realistic skin\", \"natural textures\", \"photographic finish\"\n   RIGHT: \"stylized skin tones\", \"painterly textures\", \"animated surface treatment\", \"illustrated finish\", \"cartoon shading\"\n\n6. SPECIES DESIGN - Always animated/stylized:\n   - \"surface_finish\": Use \"matte cartoon\", \"painterly finish\", \"cel-shaded\", \"illustrated treatment\"\n   - NEVER: \"realistic\", \"natural\", \"photographic\"\n\nInclude a compelling \"show_logline\" and detailed \"poster_description\".",
  
  "character_extraction": "You are the casting director for an ANIMATED or HIGHLY STYLIZED show. Your job:\n1. Read the user''s prompt and the supplied show blueprint JSON.\n2. Identify every unique character explicitly mentioned by name in the prompt. When no characters are mentioned, invent exactly six compelling characters aligned with the show''s tone.\n3. For each character, produce a detailed JSON object adhering to the supplied schema. Keep every field, even if you must infer tasteful, show-consistent values.\n4. The \"character\" field must be a unique, kebab-case identifier (e.g., \"lex-montgomery\").\n5. The \"inherits\" field MUST be the exact show blueprint string that is supplied to you—include it verbatim.\n6. Craft a \"showcase_scene_prompt\" that describes a 10 second solo scene with only the character on screen, showcasing their signature voice, action, and attitude.\n7. If you invent characters, keep the cast cohesive with the show''s world-building.\n\n!! CRITICAL - ANIMATION/ILLUSTRATION REQUIREMENTS !!\n\nThe show uses animation or highly stylized illustration (check production_style.medium). Describe ALL characters as animated/illustrated beings:\n\nABSOLUTELY FORBIDDEN WORDS:\n- \"photorealistic\", \"realistic\", \"photo-like\", \"documentary\", \"naturalistic\", \"live-action\", \"flesh-and-blood\", \"real-world\", \"natural human\"\n\nREQUIRED TERMINOLOGY - Use animation language:\n- Materials: \"animated textures\", \"cartoon surfaces\", \"stylized materials\", \"illustrated finishes\"\n- Skin: \"stylized skin tones\", \"animated skin\", \"cartoon shading\", \"illustrated complexion\"\n- Finish: \"matte cartoon\", \"cel-shaded\", \"painterly finish\", \"illustrated treatment\"\n- Subtype: \"animated\" or \"stylized\" (NEVER \"live_action\")\n- Materiality: \"animated character\" (NEVER \"flesh-and-blood performer\")\n- Scale: \"animated proportions\" (NEVER \"real-world scale\")\n\nEXAMPLES:\n✗ WRONG: \"realistic matte\", \"live-action subtype\", \"flesh-and-blood performer\", \"natural human anatomy\", \"real-world proportions\"\n✓ RIGHT: \"cartoon matte\", \"animated subtype\", \"animated character\", \"stylized human anatomy\", \"animated proportions\"\n\nDescribe every character as if they exist IN the show''s animation/illustration medium, not as real photographed people.\n\nAlways respond with structured JSON that matches the provided schema. If you refuse, emit a refusal message instead of invalid JSON.",
  
  "character_build": "You are the casting director for an ANIMATED or HIGHLY STYLIZED show.\nGenerate a complete character bible entry that mirrors the provided template.\nRespect the show blueprint and the supplied character seed.\nAlways respond with a JSON object adhering to the provided schema.\n\n!! CRITICAL - ANIMATION/STYLIZATION REQUIREMENTS !!\n\nThe show has a specific animation/illustration style (check production_style.medium). You MUST use terminology that matches:\n\nABSOLUTELY FORBIDDEN WORDS (cause moderation failures):\n- \"photorealistic\", \"realistic\", \"photo-like\", \"documentary\", \"naturalistic\", \"live-action\", \"flesh-and-blood\", \"real-world\"\n\nREQUIRED TERMINOLOGY based on production_style.medium:\n\nIF ANIMATION (Pixar, Ghibli, claymation, etc.):\n- Materials: \"animated textures\", \"cartoon surfaces\", \"stylized materials\", \"illustrated finishes\"\n- Skin: \"stylized skin tones\", \"animated skin treatment\", \"cartoon shading\"\n- Finish: \"matte cartoon\", \"cel-shaded\", \"painterly finish\", \"illustrated treatment\"\n- Features: \"animated proportions\", \"cartoon expressions\", \"stylized anatomy\"\n\nIF GRAPHIC/ILLUSTRATED:\n- Materials: \"illustrated textures\", \"graphic surfaces\", \"painterly materials\"\n- Skin: \"illustrated skin tones\", \"graphic rendering\", \"painterly complexion\"\n- Finish: \"graphic matte\", \"illustrated finish\", \"comic book treatment\"\n\nEXAMPLES:\n✗ WRONG: \"realistic matte\", \"natural human skin\", \"flesh-and-blood performer\", \"live-action subtype\"\n✓ RIGHT: \"cartoon matte\", \"stylized human features\", \"animated character\", \"animated subtype\"\n\nAlways describe characters as if they exist in the show''s animation/illustration style, NOT as photographed real people.",
  
  "portrait_base": "!! VISUAL STYLE - CRITICAL - MUST FOLLOW !!\n\nThis is a character portrait for \"{SHOW_TITLE}\"\nProduction Medium: {PRODUCTION_MEDIUM}\nVisual References: {CINEMATIC_REFERENCES}\nStylization Level: {STYLIZATION_LEVEL}\n\nStyle Treatment: {VISUAL_TREATMENT}\n\nCRITICAL RULES:\n- DO NOT use photorealistic rendering\n- DO NOT create a photo-like realistic image\n- MUST match the specified visual style (animation style OR cinematic/theatrical treatment)\n- Use artistic interpretation, NOT documentary realism",
  
  "video_base": "Produce a {DURATION}-second, {ASPECT_RATIO} cinematic showcase featuring ONLY the specified character.\nAnchor every creative choice in the show blueprint''s visual rules and the character dossier.\nThe scene must embody their hallmark voice, action, and attitude described in the showcase prompt.\n\nVISUAL STYLE (CRITICAL - Match exactly):\nMedium: {PRODUCTION_MEDIUM}\nReferences: {CINEMATIC_REFERENCES}\nTreatment: {VISUAL_TREATMENT}\nDo NOT use photorealistic rendering if the style specifies animation or stylization.",
  
  "poster_base": "!! VISUAL STYLE - CRITICAL - MUST FOLLOW !!\n\nShow Title: \"{SHOW_TITLE}\"\nProduction Medium: {PRODUCTION_MEDIUM}\nVisual References: {CINEMATIC_REFERENCES}\nStylization: {STYLIZATION_LEVEL}\n\nTreatment: {VISUAL_TREATMENT}\n\nCRITICAL REQUIREMENTS:\n1. The poster MUST prominently display the show title in bold theatrical typography\n2. DO NOT use photorealistic rendering\n3. DO NOT create a photo-like realistic image\n4. MUST match the specified visual style exactly\n5. Use artistic/stylized interpretation, NOT documentary realism\n\n---\n\nDesign a theatrical 2:3 portrait movie poster for a prestige streaming series. Capture the tone, palette, lighting, and iconography from the show''s visual bible. Focus on cinematic composition, premium typography, and evocative mood.",
  
  "trailer_base": "Create an iconic teaser trailer for the series \"{SHOW_TITLE}\".\n\n{LOGLINE}\n\nVISUAL STYLE (CRITICAL - Follow exactly):\nMedium: {PRODUCTION_MEDIUM}\nReferences: {CINEMATIC_REFERENCES}\nTreatment: {VISUAL_TREATMENT}\nStylization: {STYLIZATION_LEVEL}\n\nIMPORTANT: Match this exact visual style. Do NOT use photorealistic or realistic rendering.\n\nTRAILER REQUIREMENTS:\n\n1. DO NOT show character names or text labels - this is a visual-only teaser\n2. Study the character grid reference image to understand the cast, but let the visuals speak for themselves\n3. Create a well-paced, exciting montage that captures the show''s core vibe and genre\n4. Showcase the MOST INTERESTING and ICONIC moments that would make viewers want to watch\n5. Build anticipation and intrigue through dynamic editing and compelling visuals\n\nPACING & STRUCTURE:\n- Open with an attention-grabbing establishing shot that sets the tone\n- Quick cuts showcasing key characters in signature moments\n- Build energy and tension throughout\n- Include 2-3 memorable \"money shots\" that define the show''s unique appeal\n- End on an intriguing moment or cliffhanger that leaves viewers wanting more\n\nTONE & GENRE GUIDANCE:\n- If COMEDY: Focus on visual humor, comedic timing, absurd situations, character reactions\n- If ACTION: Emphasize dynamic movement, tension, stakes, explosive moments\n- If HORROR: Build dread, use atmosphere, shadows, unsettling imagery\n- If DRAMA: Focus on emotion, character conflict, relationships, dramatic moments\n- If ADVENTURE: Show scope, wonder, discovery, exciting set pieces\n\nVISUAL APPROACH:\n- Use dynamic camera movements and impactful compositions\n- Vary shot sizes: wide establishing shots, dramatic close-ups, mid-shots for action\n- Match the show''s visual style and production medium exactly (see above)\n- Create a sense of scale and production value\n- Every frame should feel intentional and exciting\n\nThe character grid shows your cast - use them throughout but focus on MOMENTS and ATMOSPHERE, not introductions."
}'::jsonb;

-- Add template version for tracking
ALTER TABLE shows ADD COLUMN IF NOT EXISTS template_version TEXT DEFAULT 'v1';

